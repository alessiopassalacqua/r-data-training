<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Alessio Passalacqua" />

<meta name="date" content="2021-09-07" />

<title>Visualizzazione con ggplot</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.9.4.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="css/rmarkdown.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R Data Training</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Me
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Let's start
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="WhyR.html">Why R</a>
    </li>
    <li>
      <a href="warmup.html">Intro R</a>
    </li>
    <li>
      <a href="Manipolare_i_dati_con_dplyr.html">Data Manipulation</a>
    </li>
    <li>
      <a href="basic_ggplot2.html">Visualization</a>
    </li>
  </ul>
</li>
<li>
  <a href="course.html">My Courses</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Visualizzazione con ggplot</h1>
<h4 class="author"><a href="https://alessiopassalacqua.updog.co/">Alessio Passalacqua</a></h4>
<h4 class="date">2021-09-07</h4>

</div>


<p><link rel="stylesheet" href="styles.css" type="text/css"></p>
<p><br></p>
<div id="obiettivi-di-questo-tutorial" class="section level1">
<h1>Obiettivi di questo tutorial</h1>
<p>Se R è un linguaggio, le librerie sono come dei dialetti, introducono cioè nuovi comandi specifici per una determinata task, come caricare, manipolare, rappresentare, modellare i dati, etc.. . In questo contesto <strong>ggplot</strong> è un linguaggio nel linguaggio, un dialetto con la propria grammatica. Questo introduce una maggiore complessità in ottica utente ma garantisce una flessibilità quasi illimitata per la creazione di rappresentazioni grafiche.</p>
<p>In questo tutorial imparerai:</p>
<ul>
<li>cos’è la libreria ggplot2,</li>
<li>la sintassi ggplot2,</li>
<li>rappresentare la disrtibuzioni uni/bi-variata</li>
<li>rappresentazione con scatterplot</li>
<li>personalizzare i grafici</li>
</ul>
</div>
<div id="la-libreria-grafica-ggplot2" class="section level1">
<h1>La libreria grafica ggplot2</h1>
<p>Il pacchetto <code>ggplot2</code>, o semplicemente <code>ggplot</code>, è un potente strumento per rappresentare graficamente i dati. Le iniziali del nome, <em>gg</em>, si riferiscono alla “Grammar of Graphics”, che è un modo di pensare le figure come una serie di layer stratificati. Originariamente descritta da Leland Wilkinson, la grammatica dei grafici è stata aggiornata e applicata in <code>R</code> da Hadley Wickham, il creatore del pacchetto.</p>
<p><img src="figure/grammar.png" /></p>
<p>Quando usiamo excel e più in generale un foglio di calcolo i grafici vengono presentati come template, modelli pre-impostati. La scelta avviene quindi per <em>typology</em>. In questo approccio è semplice realizzare grafici nase ma impedisce lo sviluppo grafici più complessi e più adatti ai dati a disposizione.</p>
<p>L’approccio <strong>Grammar of graphics</strong> permette invece una maggiori possibilità di combinare i diversi layout grafici rendendo i grafici più espressivi.</p>
<p>Prima di introdurre i comandi e le funzioni, è necessario focalizzarsi sul concetto di layer grafico. Come le parole all’interno di una frase hanno funzioni distinte (soggetto, predicato, complemento oggetto), così all’interno di ggplot i layer sono comandi che hanno una specifica funzione. In questa analogia possiamo vedere ogni rappresentazione grafica come una nuova frase da comporre. Ogni rappresentazione è costituita da almeno tre elementi/layers:</p>
<ul>
<li><code>data</code>, i dati che contengono le variabili attuali da plottare;</li>
<li><code>aes</code>, l’estetica dove si assegnano le variabili agli assi;</li>
<li><code>geom</code>, la geometria specifica la codifica utilizzata per rappresentare i dati;</li>
</ul>
<p>Esempio:</p>
<pre class="r"><code>ggplot(data=...,aes(x=...,y=....)) + geom_....</code></pre>
<p>Per costruire rappresentazioni più complesse esistono altri elementi/layers:</p>
<ul>
<li><code>facet</code>, la sfaccettatura crea un insieme di sub-plot</li>
<li><code>stat</code>, la statistica per generare modelli o determinare indici statistici.</li>
<li><code>coord</code>, le coordinate per specificare in quale spazio rappresentare i dati, di default spazio cartesiano.</li>
<li><code>theme</code>, descrive tutti gli elementi accessori che non costituiscono la rappresentazione dei dati ma l’aspetto finale del grafico</li>
</ul>
<p>Di particolare rilevanza il fatto che <code>ggplot2</code> possa integrarsi con libreria <code>dplyr</code> e che si possa utilizzare l’operatore <em>pipe</em> <code>%&gt;%</code>, spiegato nel tutorial <a href="https://alessiopassalacqua.github.io/r-data-training/Manipolare_i_dati_con_dplyr.html">Manipolare i dati con dplyr</a>. Queste due librerie appartengono a <em>Tidyverse</em>, una collezioni di librerie che condividono alcune funzionalità e che vengono sviluppate allo scopo di interagire al meglio.</p>
</div>
<div id="lets-start-con-ggplot" class="section level1">
<h1>Let’s start con ggplot</h1>
<p><code>ggplot2</code> è sicuramente la libreria che meglio permette di visualizzare le informazioni contenute nel dataset, ma la sua sintassi, come già accennato può richiedere un po’ di tempo per essere compresa appieno e per sfruttarne le sue potenzialità.</p>
<p>Se la libreria non è già stata installata procedere con il seguente comando:</p>
<pre class="r"><code>install.packages(&quot;ggplot2&quot;)</code></pre>
<p>Caricare la libreria:</p>
<pre class="r"><code>library(ggplot2)</code></pre>
<p>Questi cinque punti di seguito elencati sono essenziali per utilizzare la funzione <code>ggplot()</code>:</p>
<ul>
<li><p>I grafici possono essere definiti solo sui dataframe.</p></li>
<li><p>Le variabili da rappresentare, come la variabile x, la variabile y, e le variabili che definiscono il colore o la dimensione dei punti, sono dette estetiche, e sono dichiarate all’interno della funzione utilizzando l’argomento <code>aes()</code></p></li>
<li><p>La funzione <code>ggplot()</code> deve contenere il nome del dataframe e l’estetica.</p></li>
<li><p>La funzione <code>ggplot()</code> crea l’oggetto grafico e da sola non produce nessuna visualizzazione; le visualizzazioni sono prodotte dal layer <code>geom_...</code> .</p></li>
<li><p>I layer sono funzioni che vengono aggiunte con il simbolo <code>+</code></p></li>
</ul>
<p><img src="figure/ggplot_syntax-slide_v2.png" /></p>
<p>Per questo tutorial utilizzeremo il dataset <code>wine</code> contenuta nella libreria <code>rattle.data</code>:</p>
<pre class="r"><code>install.packages(&quot;rattle.data&quot;)</code></pre>
<pre class="r"><code>library(rattle.data)
data(&quot;wine&quot;)</code></pre>
<p>Per rappresentare i dati, all’interno della funzione <code>ggplot()</code> specifichiamo il dataset e l’estetitica. Il nome delle variabili/colonna all’interno del dataframe, possono essere specificate senza l’utilizzo delle virgolette.</p>
<pre class="r"><code>ggplot(wine, aes(x= Magnesium, y=Flavanoids ))</code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Il codice utilizzato inizializza l’oggetto grafico visualizzando solo il background perchè sono ancora assenti le informazioni relative a come rappresentare i dati.</p>
<p>A questo punto, come specificato nel paragrafo precedente, il terzo elemento essenziale per una rapprentazione con <code>ggplot()</code> è il comando <code>geom_....</code> che viene concatenato agli elementi precedenti tramite l’operatore <code>+</code>. Nell’esempio viene specificato <code>geom_point()</code> per rappresentare un grafico <code>scatter plot</code></p>
<pre class="r"><code>ggplot(wine, aes(x= Magnesium, y=Flavanoids )) + geom_point()</code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div id="personalizzazione-del-grafico" class="section level2">
<h2>Personalizzazione del grafico</h2>
<p>Per completare il grafico aggiugiamo elementi accessori riguardanti il tema. Per modificare le etichette agli assi e il titolo utilizziamo il comando <code>labs()</code> che va ad operare sul layer <code>themes</code>. Alcuni degli argomenti associati al comando labs sono:</p>
<ul>
<li><code>x</code>,<code>y</code> (specificano l’etichette degli assi)</li>
<li><code>title</code> (specifica il titolo del grafico)</li>
<li><code>subtitle</code> (specifica il sottotitolo)</li>
<li><code>caption</code> (specifica la didascalia)</li>
</ul>
<pre class="r"><code>ggplot(wine, aes(x= Magnesium, y=Flavanoids,colour=Hue,size=Proline ))  +
  geom_point() + 
  labs(x=&quot;Magnesium&quot;, 
       y=&quot;Flavanoids&quot;, 
       title = &quot;Wine data set&quot;,
       subtitle = &quot;Scatter plot&quot;,
       caption = &quot;Data from library rattle.data&quot;) </code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>E’ possibile anche utilizzare dei temi prestabiliti utilizzzando uno dei seguenti comandi:</p>
<ul>
<li><code>theme_gray()</code></li>
<li><code>theme_bw()</code></li>
<li><code>theme_classic()</code></li>
<li><code>theme_dark()</code></li>
<li><code>theme_gray()</code></li>
<li><code>theme_grey()</code></li>
<li><code>theme_light()</code></li>
<li><code>theme_linedraw()</code></li>
<li><code>theme_minimal()</code></li>
</ul>
<p>L’esempio successivo fa riferimento al tema <code>theme_minimal()</code>:</p>
<pre class="r"><code>ggplot(wine, aes(x= Magnesium, y=Flavanoids,colour=Hue,size=Proline ))  +
  geom_point() + 
  labs(x=&quot;Magnesium&quot;, y=&quot;Flavanoids&quot;, 
       title = &quot;Wine data set&quot;,
       subtitle = &quot;Scatter plot&quot;,
       caption = &quot;Data from library rattle.data&quot;) +
  theme_minimal()</code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Per avere una maggiore scelta sui temi si può far riferimento alla libreria <code>ggthemes</code>.</p>
</div>
</div>
<div id="visualizzazione-con-ggplot2" class="section level1">
<h1>Visualizzazione con ggplot2</h1>
<p>Nella precedente sezione è stato mostrato come costruire un grafico con la funzione <code>ggplot</code>. In questa sezione saranno presentati esempi relativi ai grafici maggiormente utilizzati durante la fase di esplorazione. L’esplorazione dei dati è la fase in cui, tramite la visualizzazione e manipolazione dei dati, si cerca di avere una maggiore comprensione delle caratteristiche del proprio dataset. I grafici si distinguono per la tipologia dei dati che essi rappresentano:</p>
<ul>
<li>variabili numeriche</li>
<li>variabili categoriche</li>
<li>varibaili numeriche e categoriche</li>
</ul>
<p>Oppure dal numero di variabili utilizzate per la rappresentazione:</p>
<ul>
<li>rapresentazioni univeriate</li>
<li>rappresentazioni bivariate</li>
<li>rappresentazioni con più di due variabili</li>
</ul>
<div id="distribuzione-univariata" class="section level2">
<h2>Distribuzione univariata</h2>
<p>La principale rappresentazione per la variabile numerica è il grafico della distribuzione che consente di visualizzare come le osservazioni sono distribuite lungo il range della variabile indagata. Le tre principali strategie per ottenere una distribuzione sono:</p>
<ul>
<li>istogramma</li>
<li>densità</li>
<li>boxplot</li>
</ul>
<p>Un istogramma visualizza la distribuzione di frequenza. Il primo passo per costruire una distribuzione di frequenza dei dati è quello di dividere il range di variabilità della variabile considerata in una serie di intervalli più piccoli (bin). Questo metodo è chiamato binning e prevede la discretizzazione della variabile continua. Per ciascun bin vengono conteggiati il numero di valori che rientrano in quell’intervallo. Il grafico riporta per ogni intervallo il numero di osservazioni.</p>
<p>Generalmente, gli istogrammi sono uno dei modi migliori modi per visualizzare rapidamente le caratteristiche di una variabile numerica. Con <code>ggplot()</code>, un istogramma è ottenutoo tramite layer <code>geom_histogram()</code>. Nell’esempio sottostante, il parametro <code>binwidth</code> si specifica la largezza del bin:</p>
<pre class="r"><code>ggplot(wine, aes(x=Alcohol)) + 
  geom_histogram(fill=&quot;#69b3a2&quot;, color=&quot;#e9ecef&quot;, alpha=0.7, binwidth = 0.5)</code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Le altre opzioni all’interno del comando <code>geom_histogram()</code> aggiungono elementi estetici come il colore delle colonne, <code>fill</code>, e la trasparenza <code>alpha</code>.</p>
<p>E’ possibile specificare il numero di bin nel quale l’intervallo sarà diviso utilizzando il paramentro <code>bins</code>.</p>
<p>Un modo alternativo per la visualizzazione della distribuzione è il grafico di densità. Il grafico densità può essere anche vista come una funzione di probabilità, ad ogni valore è associato la probabilità di poterlo ritrovare nel dataset. Il grafico densità è una versione smussata dell’istogramma e si ottiene con l’opzione <code>geom_density()</code></p>
<pre class="r"><code>ggplot(wine, aes(x=Alcohol)) + 
  geom_density(fill=&quot;#69b3a2&quot;, color=&quot;#e9ecef&quot;, alpha=0.7, bw=0.5) </code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Un Boxplot è un modo conveniente per visualizzare visivamente la distribuzione dei dati attraverso i quartili. Anche se il boxplot può sembrare un grafico semplificato rispetto ad un istogramma o grafico densità, ha il vantaggio di occupare uno spazio ridotto quindi molto utile se utilizzato per confrontare distribuzioni relative a molti gruppi o set di dati, come si vedrà nella parte successiva del tutorial.</p>
<pre class="r"><code>ggplot(wine, aes(y=Alcohol)) + geom_boxplot()  </code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="variabile-numerica-ordinata" class="section level2">
<h2>Variabile numerica ordinata</h2>
<p>ggplot è ottimale anche per visualizzare una variabile numerica ordinata. Nell’esempio proposto viene utilizzato il dataset <code>economics</code> cche contiene dati relativi all’economia statunitense.</p>
<pre class="r"><code>ggplot(economics, aes(date, unemploy)) + 
  geom_line()</code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="distribuzione-bivariata" class="section level2">
<h2>Distribuzione bivariata</h2>
<p>Per plottare la densità bidimensionale di due variabili continue utilizziamo il layer <code>geom_density2d()</code></p>
<pre class="r"><code>ggplot(wine, aes(x=Alcohol,y=Ash)) + 
  geom_density2d() + 
  geom_point() </code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Per plottare grafici dispersione si utilizza il layer <code>geom_point()</code> o in alternativa il layer <code>geom_jitter()</code>.</p>
<pre class="r"><code>ggplot(wine, aes(x=Alcohol,y=Proline)) + 
  geom_jitter()</code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>E’ possibile plottare la linea di tendenza con il layer <code>geom_smooth()</code> impostando la seguente opzione <code>method = lm</code>. La parte grigia rappresenta l’intervallo di confidenza che per default è fissato al 95%.</p>
<pre class="r"><code>ggplot(wine, aes(x=Alcohol,y=Proline)) + 
  geom_jitter() +  
  geom_smooth(method = lm)</code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Con l’opzione <code>geom_smooth(method = loess)</code> viene aggiunta una curva interpolante (LOESS, o LOWESS, locally weighted scatterplot smoothing ).</p>
<pre class="r"><code>ggplot(wine, aes(x=Alcohol,y=Proline)) + 
  geom_jitter() +  
  geom_smooth(method = loess)</code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="o-più-variabili-numeriche" class="section level2">
<h2>3 o più variabili numeriche</h2>
<p>La parte estetica, <code>aes()</code> accetta oltre agli argomenti <code>x</code> e <code>y</code> anche <code>colour</code> e <code>size</code>:</p>
<pre class="r"><code>ggplot(wine, aes(x= Magnesium, y=Flavanoids,colour=Hue,size=Proline ))  + 
  geom_point()</code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="visualizzazione-interattiva-con-la-libreria-plotly" class="section level2">
<h2>Visualizzazione interattiva con la libreria Plotly</h2>
<p>Un’altra caratteristica molto interessante di <code>ggplot2</code> è il suo collegamento con la libreria per la visualizzazione interattiva <code>plotly</code>.</p>
<pre class="r"><code>install.packages(&quot;plotly&quot;)</code></pre>
<p>Per ottenere una visualizzazione interattiva, basta usara la funzione <code>ggplotly()</code> sull’oggetto grafico creato con la funzione ggplot. Per facilitare la scrittura del codice è utile salvare l’oggetto creato da ggplot.</p>
<pre class="r"><code>library(plotly)

 
p &lt;-
  ggplot(wine, aes(x= Magnesium, y=Flavanoids,colour=Type, size=Proline )) +
  geom_point(alpha=0.5) + 
  theme_bw()
 
ggplotly(p)</code></pre>
<div id="htmlwidget-f8e4e43ba94031f396c7" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f8e4e43ba94031f396c7">{"x":{"data":[{"x":[127,100,101,113,118,112,96,121,97,98,105,95,89,91,102,112,120,115,108,116,126,102,101,95,96,124,93,94,107,96,101,106,104,132,110,100,110,98,98,128,117,90,101,103,107,111,102,101,103,108,92,94,111,115,118,116,118,102,108],"y":[3.06,2.76,3.24,3.49,2.69,3.39,2.52,2.51,2.98,3.15,3.32,2.43,2.76,3.69,3.64,2.91,3.14,3.4,3.93,3.03,3.17,2.41,2.88,2.37,2.61,2.68,2.94,2.19,2.97,2.33,3.25,3.19,2.69,2.74,2.53,2.98,2.68,2.43,2.64,3.04,3.29,2.68,3.56,2.63,3,2.65,3.17,3.39,2.92,3.54,3.27,2.99,3.74,2.79,2.9,2.78,3,3.23,3.67],"text":["Magnesium: 127<br />Flavanoids: 3.06<br />Type: 1<br />Proline: 1065","Magnesium: 100<br />Flavanoids: 2.76<br />Type: 1<br />Proline: 1050","Magnesium: 101<br />Flavanoids: 3.24<br />Type: 1<br />Proline: 1185","Magnesium: 113<br />Flavanoids: 3.49<br />Type: 1<br />Proline: 1480","Magnesium: 118<br />Flavanoids: 2.69<br />Type: 1<br />Proline:  735","Magnesium: 112<br />Flavanoids: 3.39<br />Type: 1<br />Proline: 1450","Magnesium:  96<br />Flavanoids: 2.52<br />Type: 1<br />Proline: 1290","Magnesium: 121<br />Flavanoids: 2.51<br />Type: 1<br />Proline: 1295","Magnesium:  97<br />Flavanoids: 2.98<br />Type: 1<br />Proline: 1045","Magnesium:  98<br />Flavanoids: 3.15<br />Type: 1<br />Proline: 1045","Magnesium: 105<br />Flavanoids: 3.32<br />Type: 1<br />Proline: 1510","Magnesium:  95<br />Flavanoids: 2.43<br />Type: 1<br />Proline: 1280","Magnesium:  89<br />Flavanoids: 2.76<br />Type: 1<br />Proline: 1320","Magnesium:  91<br />Flavanoids: 3.69<br />Type: 1<br />Proline: 1150","Magnesium: 102<br />Flavanoids: 3.64<br />Type: 1<br />Proline: 1547","Magnesium: 112<br />Flavanoids: 2.91<br />Type: 1<br />Proline: 1310","Magnesium: 120<br />Flavanoids: 3.14<br />Type: 1<br />Proline: 1280","Magnesium: 115<br />Flavanoids: 3.40<br />Type: 1<br />Proline: 1130","Magnesium: 108<br />Flavanoids: 3.93<br />Type: 1<br />Proline: 1680","Magnesium: 116<br />Flavanoids: 3.03<br />Type: 1<br />Proline:  845","Magnesium: 126<br />Flavanoids: 3.17<br />Type: 1<br />Proline:  780","Magnesium: 102<br />Flavanoids: 2.41<br />Type: 1<br />Proline:  770","Magnesium: 101<br />Flavanoids: 2.88<br />Type: 1<br />Proline: 1035","Magnesium:  95<br />Flavanoids: 2.37<br />Type: 1<br />Proline: 1015","Magnesium:  96<br />Flavanoids: 2.61<br />Type: 1<br />Proline:  845","Magnesium: 124<br />Flavanoids: 2.68<br />Type: 1<br />Proline:  830","Magnesium:  93<br />Flavanoids: 2.94<br />Type: 1<br />Proline: 1195","Magnesium:  94<br />Flavanoids: 2.19<br />Type: 1<br />Proline: 1285","Magnesium: 107<br />Flavanoids: 2.97<br />Type: 1<br />Proline:  915","Magnesium:  96<br />Flavanoids: 2.33<br />Type: 1<br />Proline: 1035","Magnesium: 101<br />Flavanoids: 3.25<br />Type: 1<br />Proline: 1285","Magnesium: 106<br />Flavanoids: 3.19<br />Type: 1<br />Proline: 1515","Magnesium: 104<br />Flavanoids: 2.69<br />Type: 1<br />Proline:  990","Magnesium: 132<br />Flavanoids: 2.74<br />Type: 1<br />Proline: 1235","Magnesium: 110<br />Flavanoids: 2.53<br />Type: 1<br />Proline: 1095","Magnesium: 100<br />Flavanoids: 2.98<br />Type: 1<br />Proline:  920","Magnesium: 110<br />Flavanoids: 2.68<br />Type: 1<br />Proline:  880","Magnesium:  98<br />Flavanoids: 2.43<br />Type: 1<br />Proline: 1105","Magnesium:  98<br />Flavanoids: 2.64<br />Type: 1<br />Proline: 1020","Magnesium: 128<br />Flavanoids: 3.04<br />Type: 1<br />Proline:  760","Magnesium: 117<br />Flavanoids: 3.29<br />Type: 1<br />Proline:  795","Magnesium:  90<br />Flavanoids: 2.68<br />Type: 1<br />Proline: 1035","Magnesium: 101<br />Flavanoids: 3.56<br />Type: 1<br />Proline: 1095","Magnesium: 103<br />Flavanoids: 2.63<br />Type: 1<br />Proline:  680","Magnesium: 107<br />Flavanoids: 3.00<br />Type: 1<br />Proline:  885","Magnesium: 111<br />Flavanoids: 2.65<br />Type: 1<br />Proline: 1080","Magnesium: 102<br />Flavanoids: 3.17<br />Type: 1<br />Proline: 1065","Magnesium: 101<br />Flavanoids: 3.39<br />Type: 1<br />Proline:  985","Magnesium: 103<br />Flavanoids: 2.92<br />Type: 1<br />Proline: 1060","Magnesium: 108<br />Flavanoids: 3.54<br />Type: 1<br />Proline: 1260","Magnesium:  92<br />Flavanoids: 3.27<br />Type: 1<br />Proline: 1150","Magnesium:  94<br />Flavanoids: 2.99<br />Type: 1<br />Proline: 1265","Magnesium: 111<br />Flavanoids: 3.74<br />Type: 1<br />Proline: 1190","Magnesium: 115<br />Flavanoids: 2.79<br />Type: 1<br />Proline: 1375","Magnesium: 118<br />Flavanoids: 2.90<br />Type: 1<br />Proline: 1060","Magnesium: 116<br />Flavanoids: 2.78<br />Type: 1<br />Proline: 1120","Magnesium: 118<br />Flavanoids: 3.00<br />Type: 1<br />Proline:  970","Magnesium: 102<br />Flavanoids: 3.23<br />Type: 1<br />Proline: 1270","Magnesium: 108<br />Flavanoids: 3.67<br />Type: 1<br />Proline: 1285"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.5,"size":[17.9381460639011,17.8025672771281,18.9793024986612,21.277420208169,14.5687864437638,21.0576807328664,19.8350251668053,19.8746390873891,17.7570821111796,17.7570821111796,21.494434197876,19.7555026491207,20.0712639150946,18.6831471353665,21.7584775737868,19.9929001305044,19.7555026491207,18.5112426583658,22.6771653543307,15.7973295284711,15.0875164330594,14.9743205013355,17.6656648154536,17.4810005162005,15.7973295284711,15.6372983927736,19.0628642879488,19.7953132642721,16.5175857962681,17.6656648154536,19.7953132642721,21.5303452556903,17.246609752693,19.3926398364025,18.205481531947,16.5674804574539,16.1626954055863,18.2934991513544,17.5273991351365,14.859968239211,15.2552169677887,17.6656648154536,18.205481531947,13.8987359685033,16.2140141826517,18.0724388439152,17.9381460639011,17.1992403403765,17.8930978475657,19.595258126128,18.6831471353665,19.6354710834021,19.0211406591083,20.4956994277013,17.8930978475657,18.4245337527439,17.0561180890838,19.6755823124938,19.7953132642721],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[88,101,100,94,87,104,98,78,78,110,151,103,86,87,139,101,97,86,112,136,101,86,86,78,85,94,99,90,88,84,70,81,86,80,88,98,162,134,85,88,88,97,88,98,86,85,90,80,84,92,94,107,88,103,88,84,85,86,108,80,87,96,119,102,86,82,85,86,92,88,80],"y":[0.57,1.09,1.41,1.79,3.1,1.75,2.65,3.18,2,1.3,1.28,1.02,2.86,1.84,2.89,2.14,1.57,2.03,1.32,1.85,2.55,2.26,2.53,1.58,1.59,2.21,1.94,1.69,1.61,1.69,1.59,1.5,1.25,1.46,2.25,2.26,2.27,0.99,2.5,3.75,2.99,2.17,1.36,2.11,1.64,1.92,1.84,2.03,1.76,2.04,2.92,2.58,2.27,2.03,2.01,2.29,2.17,1.6,2.09,1.25,1.64,2.79,5.08,2.13,2.65,3.03,2.65,3.15,2.24,2.45,1.75],"text":["Magnesium:  88<br />Flavanoids: 0.57<br />Type: 2<br />Proline:  520","Magnesium: 101<br />Flavanoids: 1.09<br />Type: 2<br />Proline:  680","Magnesium: 100<br />Flavanoids: 1.41<br />Type: 2<br />Proline:  450","Magnesium:  94<br />Flavanoids: 1.79<br />Type: 2<br />Proline:  630","Magnesium:  87<br />Flavanoids: 3.10<br />Type: 2<br />Proline:  420","Magnesium: 104<br />Flavanoids: 1.75<br />Type: 2<br />Proline:  355","Magnesium:  98<br />Flavanoids: 2.65<br />Type: 2<br />Proline:  678","Magnesium:  78<br />Flavanoids: 3.18<br />Type: 2<br />Proline:  502","Magnesium:  78<br />Flavanoids: 2.00<br />Type: 2<br />Proline:  510","Magnesium: 110<br />Flavanoids: 1.30<br />Type: 2<br />Proline:  750","Magnesium: 151<br />Flavanoids: 1.28<br />Type: 2<br />Proline:  718","Magnesium: 103<br />Flavanoids: 1.02<br />Type: 2<br />Proline:  870","Magnesium:  86<br />Flavanoids: 2.86<br />Type: 2<br />Proline:  410","Magnesium:  87<br />Flavanoids: 1.84<br />Type: 2<br />Proline:  472","Magnesium: 139<br />Flavanoids: 2.89<br />Type: 2<br />Proline:  985","Magnesium: 101<br />Flavanoids: 2.14<br />Type: 2<br />Proline:  886","Magnesium:  97<br />Flavanoids: 1.57<br />Type: 2<br />Proline:  428","Magnesium:  86<br />Flavanoids: 2.03<br />Type: 2<br />Proline:  392","Magnesium: 112<br />Flavanoids: 1.32<br />Type: 2<br />Proline:  500","Magnesium: 136<br />Flavanoids: 1.85<br />Type: 2<br />Proline:  750","Magnesium: 101<br />Flavanoids: 2.55<br />Type: 2<br />Proline:  463","Magnesium:  86<br />Flavanoids: 2.26<br />Type: 2<br />Proline:  278","Magnesium:  86<br />Flavanoids: 2.53<br />Type: 2<br />Proline:  714","Magnesium:  78<br />Flavanoids: 1.58<br />Type: 2<br />Proline:  630","Magnesium:  85<br />Flavanoids: 1.59<br />Type: 2<br />Proline:  515","Magnesium:  94<br />Flavanoids: 2.21<br />Type: 2<br />Proline:  520","Magnesium:  99<br />Flavanoids: 1.94<br />Type: 2<br />Proline:  450","Magnesium:  90<br />Flavanoids: 1.69<br />Type: 2<br />Proline:  495","Magnesium:  88<br />Flavanoids: 1.61<br />Type: 2<br />Proline:  562","Magnesium:  84<br />Flavanoids: 1.69<br />Type: 2<br />Proline:  680","Magnesium:  70<br />Flavanoids: 1.59<br />Type: 2<br />Proline:  625","Magnesium:  81<br />Flavanoids: 1.50<br />Type: 2<br />Proline:  480","Magnesium:  86<br />Flavanoids: 1.25<br />Type: 2<br />Proline:  450","Magnesium:  80<br />Flavanoids: 1.46<br />Type: 2<br />Proline:  495","Magnesium:  88<br />Flavanoids: 2.25<br />Type: 2<br />Proline:  290","Magnesium:  98<br />Flavanoids: 2.26<br />Type: 2<br />Proline:  345","Magnesium: 162<br />Flavanoids: 2.27<br />Type: 2<br />Proline:  937","Magnesium: 134<br />Flavanoids: 0.99<br />Type: 2<br />Proline:  625","Magnesium:  85<br />Flavanoids: 2.50<br />Type: 2<br />Proline:  428","Magnesium:  88<br />Flavanoids: 3.75<br />Type: 2<br />Proline:  660","Magnesium:  88<br />Flavanoids: 2.99<br />Type: 2<br />Proline:  406","Magnesium:  97<br />Flavanoids: 2.17<br />Type: 2<br />Proline:  710","Magnesium:  88<br />Flavanoids: 1.36<br />Type: 2<br />Proline:  562","Magnesium:  98<br />Flavanoids: 2.11<br />Type: 2<br />Proline:  438","Magnesium:  86<br />Flavanoids: 1.64<br />Type: 2<br />Proline:  415","Magnesium:  85<br />Flavanoids: 1.92<br />Type: 2<br />Proline:  672","Magnesium:  90<br />Flavanoids: 1.84<br />Type: 2<br />Proline:  315","Magnesium:  80<br />Flavanoids: 2.03<br />Type: 2<br />Proline:  510","Magnesium:  84<br />Flavanoids: 1.76<br />Type: 2<br />Proline:  488","Magnesium:  92<br />Flavanoids: 2.04<br />Type: 2<br />Proline:  312","Magnesium:  94<br />Flavanoids: 2.92<br />Type: 2<br />Proline:  680","Magnesium: 107<br />Flavanoids: 2.58<br />Type: 2<br />Proline:  562","Magnesium:  88<br />Flavanoids: 2.27<br />Type: 2<br />Proline:  325","Magnesium: 103<br />Flavanoids: 2.03<br />Type: 2<br />Proline:  607","Magnesium:  88<br />Flavanoids: 2.01<br />Type: 2<br />Proline:  434","Magnesium:  84<br />Flavanoids: 2.29<br />Type: 2<br />Proline:  385","Magnesium:  85<br />Flavanoids: 2.17<br />Type: 2<br />Proline:  407","Magnesium:  86<br />Flavanoids: 1.60<br />Type: 2<br />Proline:  495","Magnesium: 108<br />Flavanoids: 2.09<br />Type: 2<br />Proline:  345","Magnesium:  80<br />Flavanoids: 1.25<br />Type: 2<br />Proline:  372","Magnesium:  87<br />Flavanoids: 1.64<br />Type: 2<br />Proline:  564","Magnesium:  96<br />Flavanoids: 2.79<br />Type: 2<br />Proline:  625","Magnesium: 119<br />Flavanoids: 5.08<br />Type: 2<br />Proline:  465","Magnesium: 102<br />Flavanoids: 2.13<br />Type: 2<br />Proline:  365","Magnesium:  86<br />Flavanoids: 2.65<br />Type: 2<br />Proline:  380","Magnesium:  82<br />Flavanoids: 3.03<br />Type: 2<br />Proline:  380","Magnesium:  85<br />Flavanoids: 2.65<br />Type: 2<br />Proline:  378","Magnesium:  86<br />Flavanoids: 3.15<br />Type: 2<br />Proline:  352","Magnesium:  92<br />Flavanoids: 2.24<br />Type: 2<br />Proline:  466","Magnesium:  88<br />Flavanoids: 2.45<br />Type: 2<br />Proline:  342","Magnesium:  80<br />Flavanoids: 1.75<br />Type: 2<br />Proline:  580"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":0.5,"size":[11.6308207753753,13.8987359685033,10.398609194003,13.248543456363,9.79372506394939,8.20825421876034,13.8735324214986,11.3331891301939,11.4668926352408,14.7444234688382,14.3662091722584,16.059414470639,9.57809188773172,10.80918850885,17.1992403403765,16.2242525430718,9.96081790259482,9.16825154868979,11.2993918171706,14.7444234688382,10.644193031633,3.77952755905512,14.3179780256894,13.248543456363,11.5492890413399,11.6308207753753,10.398609194003,11.214226395151,12.284887237267,13.8987359685033,13.1810513922659,10.9526657671431,10.398609194003,11.214226395151,5.52786048641506,7.9106770930599,16.7356851311749,13.1810513922659,9.96081790259482,13.6438031090231,9.48955898910613,14.2695251232147,12.284887237267,10.1635367746823,9.6868924496674,13.7975413417661,6.84949928695108,11.4668926352408,11.0933289260319,6.72241039801724,13.8987359685033,12.284887237267,7.23957810263917,12.9339608210924,10.0832315752334,9.00018746835884,9.51182040464299,11.214226395151,7.9106770930599,8.67277796428809,12.3147831455369,13.1810513922659,10.681199582646,8.48705803484171,8.87675015686005,8.87675015686005,8.82652999027685,8.12112321274755,10.6996286462232,7.81712950403251,12.5502826743852],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)"}},"hoveron":"points","name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[122,104,98,106,85,94,89,96,88,101,96,89,97,92,112,102,80,86,92,113,123,112,116,98,103,93,89,97,98,89,88,107,106,106,90,88,111,88,105,112,96,86,91,95,102,120,120,96],"y":[1.25,1.22,1.09,1.2,0.58,0.66,0.47,0.6,0.48,0.6,0.5,0.5,0.52,0.8,0.78,0.55,0.34,0.65,0.76,1.39,1.57,1.36,1.28,0.83,0.58,0.63,0.83,0.58,1.31,1.1,0.92,0.56,0.6,0.7,0.68,0.47,0.92,0.66,0.84,0.96,0.49,0.51,0.7,0.61,0.75,0.69,0.68,0.76],"text":["Magnesium: 122<br />Flavanoids: 1.25<br />Type: 3<br />Proline:  630","Magnesium: 104<br />Flavanoids: 1.22<br />Type: 3<br />Proline:  530","Magnesium:  98<br />Flavanoids: 1.09<br />Type: 3<br />Proline:  560","Magnesium: 106<br />Flavanoids: 1.20<br />Type: 3<br />Proline:  600","Magnesium:  85<br />Flavanoids: 0.58<br />Type: 3<br />Proline:  650","Magnesium:  94<br />Flavanoids: 0.66<br />Type: 3<br />Proline:  695","Magnesium:  89<br />Flavanoids: 0.47<br />Type: 3<br />Proline:  720","Magnesium:  96<br />Flavanoids: 0.60<br />Type: 3<br />Proline:  515","Magnesium:  88<br />Flavanoids: 0.48<br />Type: 3<br />Proline:  580","Magnesium: 101<br />Flavanoids: 0.60<br />Type: 3<br />Proline:  590","Magnesium:  96<br />Flavanoids: 0.50<br />Type: 3<br />Proline:  600","Magnesium:  89<br />Flavanoids: 0.50<br />Type: 3<br />Proline:  780","Magnesium:  97<br />Flavanoids: 0.52<br />Type: 3<br />Proline:  520","Magnesium:  92<br />Flavanoids: 0.80<br />Type: 3<br />Proline:  550","Magnesium: 112<br />Flavanoids: 0.78<br />Type: 3<br />Proline:  855","Magnesium: 102<br />Flavanoids: 0.55<br />Type: 3<br />Proline:  830","Magnesium:  80<br />Flavanoids: 0.34<br />Type: 3<br />Proline:  415","Magnesium:  86<br />Flavanoids: 0.65<br />Type: 3<br />Proline:  625","Magnesium:  92<br />Flavanoids: 0.76<br />Type: 3<br />Proline:  650","Magnesium: 113<br />Flavanoids: 1.39<br />Type: 3<br />Proline:  550","Magnesium: 123<br />Flavanoids: 1.57<br />Type: 3<br />Proline:  500","Magnesium: 112<br />Flavanoids: 1.36<br />Type: 3<br />Proline:  480","Magnesium: 116<br />Flavanoids: 1.28<br />Type: 3<br />Proline:  425","Magnesium:  98<br />Flavanoids: 0.83<br />Type: 3<br />Proline:  675","Magnesium: 103<br />Flavanoids: 0.58<br />Type: 3<br />Proline:  640","Magnesium:  93<br />Flavanoids: 0.63<br />Type: 3<br />Proline:  725","Magnesium:  89<br />Flavanoids: 0.83<br />Type: 3<br />Proline:  480","Magnesium:  97<br />Flavanoids: 0.58<br />Type: 3<br />Proline:  880","Magnesium:  98<br />Flavanoids: 1.31<br />Type: 3<br />Proline:  660","Magnesium:  89<br />Flavanoids: 1.10<br />Type: 3<br />Proline:  620","Magnesium:  88<br />Flavanoids: 0.92<br />Type: 3<br />Proline:  520","Magnesium: 107<br />Flavanoids: 0.56<br />Type: 3<br />Proline:  680","Magnesium: 106<br />Flavanoids: 0.60<br />Type: 3<br />Proline:  570","Magnesium: 106<br />Flavanoids: 0.70<br />Type: 3<br />Proline:  675","Magnesium:  90<br />Flavanoids: 0.68<br />Type: 3<br />Proline:  615","Magnesium:  88<br />Flavanoids: 0.47<br />Type: 3<br />Proline:  520","Magnesium: 111<br />Flavanoids: 0.92<br />Type: 3<br />Proline:  695","Magnesium:  88<br />Flavanoids: 0.66<br />Type: 3<br />Proline:  685","Magnesium: 105<br />Flavanoids: 0.84<br />Type: 3<br />Proline:  750","Magnesium: 112<br />Flavanoids: 0.96<br />Type: 3<br />Proline:  630","Magnesium:  96<br />Flavanoids: 0.49<br />Type: 3<br />Proline:  510","Magnesium:  86<br />Flavanoids: 0.51<br />Type: 3<br />Proline:  470","Magnesium:  91<br />Flavanoids: 0.70<br />Type: 3<br />Proline:  660","Magnesium:  95<br />Flavanoids: 0.61<br />Type: 3<br />Proline:  740","Magnesium: 102<br />Flavanoids: 0.75<br />Type: 3<br />Proline:  750","Magnesium: 120<br />Flavanoids: 0.69<br />Type: 3<br />Proline:  835","Magnesium: 120<br />Flavanoids: 0.68<br />Type: 3<br />Proline:  840","Magnesium:  96<br />Flavanoids: 0.76<br />Type: 3<br />Proline:  560"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":0.5,"size":[13.248543456363,11.7913955386658,12.2548858750756,12.8360496288809,13.5138333263721,14.0857981680078,14.3902425326161,11.5492890413399,12.5502826743852,12.6943112719202,12.8360496288809,15.0875164330594,11.6308207753753,12.1032572057257,15.9028434227194,15.6372983927736,9.6868924496674,13.1810513922659,13.5138333263721,12.1032572057257,11.2993918171706,10.9526657671431,9.8986928048149,13.835608662388,13.3821045786652,14.4500891153739,10.9526657671431,16.1626954055863,13.6438031090231,13.1130712970676,11.6308207753753,13.8987359685033,12.4038490940522,13.835608662388,13.0445924283561,11.6308207753753,14.0857981680078,13.9614718974851,14.7444234688382,13.248543456363,11.4668926352408,10.7728592684949,13.6438031090231,14.6276480855935,14.7444234688382,15.6908810011297,15.7442236479268,12.2548858750756],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)"}},"hoveron":"points","name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":31.4155251141553},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[65.4,166.6],"tickmode":"array","ticktext":["80","100","120","140","160"],"tickvals":[80,100,120,140,160],"categoryorder":"array","categoryarray":["80","100","120","140","160"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Magnesium","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.103,5.317],"tickmode":"array","ticktext":["1","2","3","4","5"],"tickvals":[1,2,3,4,5],"categoryorder":"array","categoryarray":["1","2","3","4","5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Flavanoids","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.93503937007874},"annotations":[{"text":"Type<br />Proline","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"b6431ac2c09":{"x":{},"y":{},"colour":{},"size":{},"type":"scatter"}},"cur_data":"b6431ac2c09","visdat":{"b6431ac2c09":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="correlogramma" class="section level2">
<h2>Correlogramma</h2>
<p>Il correlogramma è utilizzato per l’analisi di un data frame con un numero variabili maggiori di tre. Per questo esempio, utilizzeremo la libreria <code>GGally</code> che è un’estensione della libreria <code>ggplot2</code>:</p>
<pre class="r"><code>install.packages(&quot;GGally&quot;)</code></pre>
<pre class="r"><code>library(GGally)
ggpairs(wine[2:5])</code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
</div>
<div id="variabile-categorica" class="section level1">
<h1>Variabile categorica</h1>
<p>Se si considerera invece una variabile categorica, la frequenza è visualizzabile tramite il layer <code>geom_bar</code></p>
<pre class="r"><code>ggplot(wine, aes(Type)) + geom_bar()</code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Nel codice precedente, l’argomento <code>geom_bar</code> ha utilizzato il valore di default <code>stat="bin"</code>, in questo caso l’altezza rappresenta il conteggio dei casi di ciascuna categoria. Nel caso si volesse plottare direttamente il valore di un’osservazione si deve utilizzare l’opzione <code>stat = "identity"</code> come mostrato nel grafico successivo:</p>
<pre class="r"><code>library(dplyr)
wine %&gt;% 
  group_by(Type) %&gt;%
  summarize(nType = n()) %&gt;%
  ggplot(aes(x=Type,y=nType)) + geom_bar(stat=&quot;identity&quot;)</code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<div id="distribuzione-numerica-vs-categorica" class="section level2">
<h2>Distribuzione Numerica Vs Categorica</h2>
<p>Un boxplot può essere utilizzato per confrontare la distribuzione di una variabile abbinata ad una variabile categorica. La variabile categorica deve essere specificata nelle x mentre la variabile continua nelle y. Nel codice successivo, al layer del boxplot viene sovrapposto il layer <code>geom_jitter()</code> che, a differenza di <code>geom_point()</code>, cerca di separare i punti che si sovrappongono.</p>
<pre class="r"><code>ggplot(wine, aes(x=Type,y=Proline))  + 
  geom_boxplot() + 
  geom_jitter()</code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Nel prossimo esempio, la variabile categorica è anche associata all’asse estetico <code>colour</code></p>
<pre class="r"><code>ggplot(wine, aes(x=Type,y=Proline,colour=Type))  + 
  geom_boxplot() + 
  geom_jitter()</code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>Alternativativamente, le distribuzioni delle tre categorie possono essere visualizzate tramite il layer densità. In questo caso la variabile continua investigata deve essere specificata in x e la variabile categorica tramite l’asse estetico <code>fill</code> (alternativa a <code>colour</code>). L’opzione <code>alpha</code> determina la trasparenza delle superfici:</p>
<pre class="r"><code>ggplot(wine, aes(x=Proline,fill=Type))  + 
  geom_density(alpha=.3)</code></pre>
<p><img src="basic_ggplot2_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
</div>
<div id="salvare-i-grafici" class="section level1">
<h1>Salvare i grafici</h1>
<p><code>ggsave()</code> è la funzione di ggplot() che permette il salvataggio in diverisi formati dei grafici creati :</p>
<ul>
<li>png</li>
<li>tex</li>
<li>pdf</li>
<li>jpeg</li>
<li>tiff</li>
<li>bmp</li>
<li>svg</li>
</ul>
<pre class="r"><code>ggplot(wine, aes(x=Proline,fill=Type))  + 
  geom_density(alpha=.3)
  ggsave(&quot;wine.png&quot;)</code></pre>
<p>E’ possibile anche impostare il formato con gli argomenti <code>width</code> e <code>height</code>:</p>
<pre class="r"><code>ggsave(&quot;wine.png&quot;, width=10, height=14, units=&quot;cm&quot;)</code></pre>
</div>
<div id="letture-di-approfondimento" class="section level1">
<h1>Letture di Approfondimento</h1>
<ul>
<li><p><a href="https://www.r-graph-gallery.com/portfolio/ggplot2-package/">The R graph gallery</a></p></li>
<li><p>visitare il sito di riferimento di Hadley Wickham <a href="http://ggplot2.org">http://ggplot2.org</a>; fornisce indicazioni per la documentazione online</p></li>
<li><p><a href="http://www.cookbook-r.com/Graphs/">Cookbook for R &gt;&gt; Graphs</a></p></li>
<li><p>Molto utile per ricordarsi i comandi è anche cheatsheet di ggoplot2 che si può trovare al sito di <a href="https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf">RStudio</a></p></li>
<li><p>Tutorial: <a href="http://www.sthda.com/english/wiki/ggplot2-essentials">ggplot2 - Essentials</a></p></li>
<li><p><a href="http://www.sthda.com/english/wiki/ggplot2-barplots-quick-start-guide-r-software-and-data-visualization">ggplot2 barplots : Quick start guide - R software and data visualization</a></p></li>
<li><p><a href="http://felixfan.github.io/Scatterplot-many-points/">Scatterplot with a lot of points</a></p></li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>


</body>
</html>
